import{supabase}from"../js/supabaseClient.js";function loadSearchBarTextInput(){const e=sessionStorage.getItem("states");if(!e)return;const t=JSON.parse(e);if(t.rawSearch){const e=document.getElementById("searchInput"),n=document.getElementById("searchInputMobile");e&&(e.value=t.rawSearch),n&&(n.value=t.rawSearch)}}function setSearchPlaceholderText(){const e=document.getElementById("searchInput"),t=document.getElementById("searchInputMobile"),n="Search items...";e&&(e.placeholder=n),t&&(t.placeholder=n)}window.addEventListener("DOMContentLoaded",()=>{loadSearchBarTextInput(),setSearchPlaceholderText()});const loginForm=document.getElementById("loginForm"),successContent=document.getElementById("successContent"),denyMessage=document.getElementById("denyMessage"),incorrectLoginText="Incorrect User ID or Password. Please try again.",noPermissionText="You don't have permission to access this page.";function handleLoginSuccess(){loginForm.classList.add("hidden"),denyMessage.classList.add("hidden"),successContent.classList.remove("hidden")}async function login(){const e=document.getElementById("userID").value.toLowerCase(),t=document.getElementById("password").value,{data:n,error:s}=await supabase.auth.signInWithPassword({email:`${e}@mpcatalog.com`,password:t});if(s)return denyMessage.textContent=incorrectLoginText,void denyMessage.classList.remove("hidden");const o=n.user;if("council"!==o.user_metadata?.role)return denyMessage.textContent=noPermissionText,void denyMessage.classList.remove("hidden");handleLoginSuccess()}function init(){supabase.auth.getSession().then(({data:{session:e},error:t})=>{t?console.error("Error fetching session:",t):e&&(window.location.href="../")}),loginForm.classList.remove("hidden"),successContent.classList.add("hidden"),denyMessage.classList.add("hidden")}function handleSearchInputClicked(){sessionStorage.setItem("focusSearch","1"),window.location.href="../catalog/"}init(),loginForm.addEventListener("submit",e=>{e.preventDefault(),login()});const desktopSearchInput=document.getElementById("searchInput"),mobileSearchInput=document.getElementById("searchInputMobile");desktopSearchInput&&desktopSearchInput.addEventListener("click",handleSearchInputClicked),mobileSearchInput&&mobileSearchInput.addEventListener("click",handleSearchInputClicked);